{"remainingRequest":"I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\node_modules\\babel-loader\\lib\\index.js!I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\src\\views\\home\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\src\\views\\home\\Home.vue","mtime":1651717558728},{"path":"I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\babel.config.js","mtime":1650683489000},{"path":"I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"I:\\SmallProject\\mySuperMall-master\\mySuperMall-test\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _toConsumableArray from \"I:/SmallProject/mySuperMall-master/mySuperMall-test/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport NavBar from \"components/common/navbar/NavBar\";\nimport Scroll from '@/components/common/scroll/Scroll.vue';\nimport TabControl from '@/components/content/tabControl/TabControl.vue';\nimport GoodsList from '@/components/content/goods/goodsList.vue';\nimport BackTop from '@/components/content/backTop/BackTop.vue';\nimport HomeSwiper from \"./childComps/HomeSwiper\";\nimport RecommendView from \"./childComps/RecommendView.vue\";\nimport FeatureView from \"./childComps/FeatureView.vue\";\nimport { getHomeMultidata as _getHomeMultidata, getHomeGoods as _getHomeGoods } from \"@/network/home.js\";\nimport { debounce } from \"@/common/utils\";\nexport default {\n  name: \"Home\",\n  components: {\n    NavBar: NavBar,\n    Scroll: Scroll,\n    TabControl: TabControl,\n    GoodsList: GoodsList,\n    BackTop: BackTop,\n    HomeSwiper: HomeSwiper,\n    RecommendView: RecommendView,\n    FeatureView: FeatureView\n  },\n  data: function data() {\n    return {\n      banners: [],\n      recommends: [],\n      goods: {\n        'pop': {\n          page: 0,\n          list: []\n        },\n        'new': {\n          page: 0,\n          list: []\n        },\n        'sell': {\n          page: 0,\n          list: []\n        }\n      },\n      currentType: \"pop\",\n      isShowBackTop: false,\n      tabOffsetTop: 0,\n      isTabFixed: false,\n      saveY: 0\n    };\n  },\n  computed: {\n    showGoods: function showGoods() {\n      return this.goods[this.currentType].list;\n    }\n  },\n  created: function created() {\n    //1.请求多个数据\n    this.getHomeMultidata(); //2.请求商品数据\n\n    this.getHomeGoods('pop');\n    this.getHomeGoods('new');\n    this.getHomeGoods('sell');\n  },\n  mounted: function mounted() {\n    //created 3.监听item中图片加载完成\n    var refresh = debounce(this.$refs.scroll.refresh, 50);\n    this.$bus.$on('itemImageLoad', function () {\n      //this.$refs.scroll.refresh();\n      refresh();\n    });\n  },\n  activated: function activated() {\n    this.$refs.scroll.scrollTo(0, this.saveY, 100);\n    this.$refs.scroll.refresh(); //console.log('lakai');\n  },\n  deactivated: function deactivated() {\n    this.saveY = this.$refs.scroll.getScrollY(); //console.log(this.$refs.scroll.getScrollY);\n    //console.log(this.$refs.scroll.getScrollY());\n  },\n  methods: {\n    //防抖函数\n\n    /*         debounce(func,delay) {\r\n                let timer = null;\r\n                return function(...args){\r\n                    if(timer) clearTimeout(timer)\r\n    \r\n                    timer = setTimeout(() => {\r\n                        func.apply(this,args)\r\n                    }, delay);\r\n                }\r\n            }, */\n\n    /**\r\n     * 事件监听的相关的方法\r\n     */\n    tabClick: function tabClick(index) {\n      switch (index) {\n        case 0:\n          this.currentType = 'pop';\n          break;\n\n        case 1:\n          this.currentType = 'new';\n          break;\n\n        case 2:\n          this.currentType = 'sell';\n          break;\n      }\n\n      this.$refs.tabControl1.currentIndex = index;\n      this.$refs.tabControl2.currentIndex = index;\n    },\n    backClick: function backClick() {\n      this.$refs.scroll.scrollTo(0, 0, 2000);\n    },\n    contentScroll: function contentScroll(position) {\n      //1.判断BackTop是否显示\n      this.isShowBackTop = -position.y > 1000; //这里的处理牛逼\n      //2.决定tabControl是否吸顶（position：fixed）\n\n      this.isTabFixed = -position.y > this.tabOffsetTop;\n    },\n    loadMore: function loadMore() {\n      //console.log('上啦加载更多');\n      this.getHomeGoods(this.currentType);\n    },\n    swiperImageLoad: function swiperImageLoad() {\n      //1.获取tabcontrol的offsetTop\n      //所有组件都有一个属性$el：用于获取组件中的元素\n      this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;\n    },\n\n    /**\r\n     * 网络请求相关的方法\r\n     */\n    getHomeMultidata: function getHomeMultidata() {\n      var _this = this;\n\n      _getHomeMultidata().then(function (res) {\n        _this.banners = res.data.banner.list;\n        _this.recommends = res.data.recommend.list;\n      });\n    },\n    getHomeGoods: function getHomeGoods(type) {\n      var _this2 = this;\n\n      var page = this.goods[type].page + 1;\n\n      _getHomeGoods(type, page).then(function (res) {\n        var _this2$goods$type$lis;\n\n        (_this2$goods$type$lis = _this2.goods[type].list).push.apply(_this2$goods$type$lis, _toConsumableArray(res.data.list));\n\n        _this2.goods[type].page += 1;\n\n        _this2.$refs.scroll.finishPullUp();\n      });\n    }\n  }\n};",{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AAEA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AAIA;AACAA,cADA;AAEAC;AACAC,kBADA;AAEAC,kBAFA;AAGAC,0BAHA;AAIAC,wBAJA;AAKAC,oBALA;AAMAC,0BANA;AAOAC,gCAPA;AAQAC;AARA,GAFA;AAeAC,MAfA,kBAeA;AACA;AACAC,iBADA;AAEAC,oBAFA;AAGAC;AACA;AAAAC;AAAAC;AAAA,SADA;AAEA;AAAAD;AAAAC;AAAA,SAFA;AAGA;AAAAD;AAAAC;AAAA;AAHA,OAHA;AAQAC,wBARA;AASAC,0BATA;AAUAC,qBAVA;AAWAC,uBAXA;AAYAC;AAZA;AAeA,GA/BA;AAgCAC;AACAC,aADA,uBACA;AACA;AACA;AAHA,GAhCA;AAsCAC,SAtCA,qBAsCA;AAEA;AACA,4BAHA,CAIA;;AACA;AACA;AACA;AACA,GA9CA;AA+CAC,SA/CA,qBA+CA;AAGA;AACA;AACA;AACA;AACAC;AACA,KAHA;AAIA,GAxDA;AAyDAC,WAzDA,uBAyDA;AACA;AACA,gCAFA,CAGA;AACA,GA7DA;AA8DAC,aA9DA,yBA8DA;AACA,gDADA,CAEA;AACA;AACA,GAlEA;AAmEAC;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACAC,YAnBA,oBAmBAC,KAnBA,EAmBA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;;AACA;AACA;AACA;AATA;;AAWA;AACA;AACA,KAjCA;AAmCAC,aAnCA,uBAmCA;AACA;AACA,KArCA;AAsCAC,iBAtCA,yBAsCAC,QAtCA,EAsCA;AACA;AACA,8CAFA,CAEA;AAEA;;AACA;AAEA,KA7CA;AA8CAC,YA9CA,sBA8CA;AACA;AACA;AACA,KAjDA;AAkDAC,mBAlDA,6BAkDA;AACA;AACA;AACA;AAGA,KAxDA;;AAyDA;AACA;AACA;AACAC,oBA5DA,8BA4DA;AAAA;;AACAA;AACA;AACA;AACA,OAHA;AAIA,KAjEA;AAkEAC,gBAlEA,wBAkEAC,IAlEA,EAkEA;AAAA;;AACA;;AACAD;AAAA;;AACA;;AACA;;AACA;AAEA,OALA;AAMA;AA1EA;AAnEA","names":["name","components","NavBar","Scroll","TabControl","GoodsList","BackTop","HomeSwiper","RecommendView","FeatureView","data","banners","recommends","goods","page","list","currentType","isShowBackTop","tabOffsetTop","isTabFixed","saveY","computed","showGoods","created","mounted","refresh","activated","deactivated","methods","tabClick","index","backClick","contentScroll","position","loadMore","swiperImageLoad","getHomeMultidata","getHomeGoods","type"],"sourceRoot":"src/views/home","sources":["Home.vue"],"sourcesContent":["<!--\r\n * @Author: your name\r\n * @Date: 2022-04-26 09:27:03\r\n * @LastEditTime: 2022-05-05 10:25:58\r\n * @LastEditors: jxc 1225100315@qq.com\r\n * @Description: 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE\r\n * @FilePath: \\mySuperMall-test\\src\\views\\home\\Home.vue\r\n-->\r\n<template>\r\n    <div id =\"home\">\r\n        <nav-bar class=\"home-nav\"><div slot=\"center\">购物车</div></nav-bar>\r\n\r\n\r\n        <tab-control :titles=\"['流行', '精选', '新款']\"\r\n            @TabClick=\"tabClick\" \r\n            ref=\"tabControl1\"\r\n            class=\"tab-control\"\r\n            v-show=\"isTabFixed\"/>\r\n\r\n        <scroll class=\"content\" ref=\"scroll\" \r\n            :probe-type=\"3\" @scroll=\"contentScroll\"\r\n            :pull-up-load=\"true\" @pullingUp=\"loadMore\">   <!-- class样式中必须设置高度 -->\r\n        <home-swiper :banners=\"banners\" @swiperImageLoad=\"swiperImageLoad\"/>\r\n        <recommend-view :recommends=\"recommends\"/>\r\n        <feature-view/>\r\n        <tab-control :titles=\"['流行', '精选', '新款']\"\r\n                    @TabClick=\"tabClick\" \r\n                    ref=\"tabControl2\" />\r\n\r\n        <goods-list :goods=\"showGoods\"/>\r\n        </scroll>\r\n        <back-top @click.native=\"backClick\" v-show=\"isShowBackTop\"/>        <!--修饰.native修饰什么时候用？  \r\n                                                                在我们需要监听一个组件的原生事件时，必须给对应的事件加上.native修饰符，才能进行监听-->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport NavBar from \"components/common/navbar/NavBar\"\r\nimport Scroll from '@/components/common/scroll/Scroll.vue'\r\n\r\nimport TabControl from '@/components/content/tabControl/TabControl.vue'\r\nimport GoodsList from '@/components/content/goods/goodsList.vue'\r\nimport BackTop from '@/components/content/backTop/BackTop.vue'\r\n\r\n\r\nimport HomeSwiper from \"./childComps/HomeSwiper\"\r\nimport RecommendView from './childComps/RecommendView.vue'\r\nimport FeatureView from './childComps/FeatureView.vue'\r\n\r\nimport {getHomeMultidata,getHomeGoods} from \"@/network/home.js\"\r\nimport {debounce} from \"@/common/utils\"\r\n\r\n\r\n\r\nexport default {\r\n    name:\"Home\",\r\n    components: { \r\n        NavBar,\r\n        Scroll,\r\n        TabControl,\r\n        GoodsList,\r\n        BackTop,\r\n        HomeSwiper,\r\n        RecommendView,\r\n        FeatureView,\r\n        \r\n        \r\n        \r\n      },\r\n      data(){\r\n          return{\r\n              banners: [],\r\n              recommends: [],\r\n              goods: {\r\n                  'pop': {page: 0, list: []},\r\n                  'new': {page: 0, list: []},\r\n                  'sell': {page: 0, list: []}\r\n              },\r\n            currentType: \"pop\",\r\n            isShowBackTop: false,\r\n            tabOffsetTop: 0,\r\n            isTabFixed: false,\r\n            saveY: 0,\r\n          }\r\n         \r\n      },\r\n      computed: {\r\n          showGoods() {\r\n             return this.goods[this.currentType].list;\r\n          },\r\n\r\n      },\r\n    created() {\r\n\r\n        //1.请求多个数据\r\n        this.getHomeMultidata()\r\n        //2.请求商品数据\r\n        this.getHomeGoods('pop')\r\n        this.getHomeGoods('new')\r\n        this.getHomeGoods('sell')\r\n      },\r\n    mounted() {\r\n\r\n\r\n        //created 3.监听item中图片加载完成\r\n        const refresh = debounce(this.$refs.scroll.refresh,50);\r\n        this.$bus.$on('itemImageLoad',()=> {\r\n        //this.$refs.scroll.refresh();\r\n        refresh();\r\n      })\r\n      },\r\n    activated() {\r\n        this.$refs.scroll.scrollTo(0,this.saveY,100)\r\n        this.$refs.scroll.refresh()\r\n        //console.log('lakai');\r\n      },\r\n    deactivated() {\r\n        this.saveY = this.$refs.scroll.getScrollY()\r\n        //console.log(this.$refs.scroll.getScrollY);\r\n        //console.log(this.$refs.scroll.getScrollY());\r\n      },\r\n    methods: {\r\n\r\n\r\n        //防抖函数\r\n\r\n/*         debounce(func,delay) {\r\n            let timer = null;\r\n            return function(...args){\r\n                if(timer) clearTimeout(timer)\r\n\r\n                timer = setTimeout(() => {\r\n                    func.apply(this,args)\r\n                }, delay);\r\n            }\r\n        }, */\r\n\r\n        /**\r\n         * 事件监听的相关的方法\r\n         */\r\n        tabClick(index) {\r\n            switch (index) {\r\n                case 0:\r\n                    this.currentType ='pop'; \r\n                    break;\r\n                case 1:\r\n                    this.currentType = 'new';\r\n                    break;\r\n                case 2:\r\n                    this.currentType = 'sell';\r\n                    break;\r\n            }\r\n            this.$refs.tabControl1.currentIndex = index;\r\n            this.$refs.tabControl2.currentIndex = index;\r\n        },\r\n\r\n        backClick() {\r\n            this.$refs.scroll.scrollTo(0,0,2000)\r\n        },\r\n        contentScroll(position) {\r\n            //1.判断BackTop是否显示\r\n            this.isShowBackTop = (-position.y) > 1000   //这里的处理牛逼\r\n\r\n            //2.决定tabControl是否吸顶（position：fixed）\r\n            this.isTabFixed = (-position.y) > this.tabOffsetTop\r\n\r\n        },\r\n        loadMore() {\r\n            //console.log('上啦加载更多');\r\n            this.getHomeGoods(this.currentType);\r\n        },\r\n        swiperImageLoad() {\r\n          //1.获取tabcontrol的offsetTop\r\n          //所有组件都有一个属性$el：用于获取组件中的元素\r\n          this.tabOffsetTop = this.$refs.tabControl2.$el.offsetTop;\r\n        \r\n\r\n        },\r\n        /**\r\n         * 网络请求相关的方法\r\n         */\r\n        getHomeMultidata() {\r\n            getHomeMultidata().then(res => {\r\n                this.banners = res.data.banner.list;\r\n                this.recommends = res.data.recommend.list;\r\n            })\r\n        },\r\n        getHomeGoods(type) {\r\n            const page = this.goods[type].page+1;\r\n            getHomeGoods(type,page).then(res => {\r\n                this.goods[type].list.push(...res.data.list);\r\n                this.goods[type].page += 1;\r\n                this.$refs.scroll.finishPullUp();\r\n\r\n            })\r\n        },\r\n        \r\n\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/**scoped限定css样式只在这个页面起效果，同名作用域问题 */\r\n#home {\r\n    /* padding-top:44px; */\r\n    height: 100vh;      /**vh 视口高度 */\r\n    position: relative;\r\n}\r\n.home-nav{\r\n    background-color: var(--color-tint);\r\n    color: #fff;\r\n\r\n    /**在使用浏览器原生滚动时，为了让导航不跟随一起滚动 */\r\n    /* position: fixed;\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n    z-index: 9; *加入框架后，属性不起作用 */\r\n}\r\n/* .tab-control {\r\n    position: sticky;\r\n    top: 44px;\r\n    z-index: 9;\r\n    加入框架后，属性不起作用\r\n} */\r\n.content {\r\n    overflow: hidden;\r\n    position: absolute;\r\n    top: 44px;\r\n    bottom: 49px;\r\n    left: 0;\r\n    right: 0;\r\n    \r\n}\r\n.tab-control {\r\n    position: relative;\r\n    z-index: 9;\r\n}\r\n/** 两种解决办法中的第二种\r\n.content {\r\n    height: calc(100% - 93px);\r\n    overflow: hidden;\r\n    margin-top: 44px;\r\n    \r\n} \r\n*/\r\n\r\n</style>"]}]}